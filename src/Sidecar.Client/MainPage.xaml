<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:skia="clr-namespace:SkiaSharp.Views.Maui.Controls;assembly=SkiaSharp.Views.Maui.Controls"
             xmlns:vm="clr-namespace:Sidecar.Client.ViewModels"
             x:Class="Sidecar.Client.MainPage"
             x:DataType="vm:MainPageViewModel"
             Title="Sidecar Client">

    <Grid RowDefinitions="Auto,*,Auto"
          Padding="16"
          BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}">

        <!-- 接続パネル -->
        <Border Grid.Row="0"
                Padding="16"
                Margin="0,0,0,16"
                StrokeShape="RoundRectangle 8"
                Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#3E3E3E}"
                BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}">
            <VerticalStackLayout Spacing="12">
                <Label Text="接続設定"
                       FontSize="18"
                       FontAttributes="Bold" />

                <Grid ColumnDefinitions="*,120"
                      ColumnSpacing="12">
                    <Entry Grid.Column="0"
                           Placeholder="ホストIPアドレス (例: 192.168.1.100)"
                           Text="{Binding HostAddress}"
                           IsEnabled="{Binding IsConnected, Converter={StaticResource InvertedBoolConverter}}"
                           Keyboard="Url" />

                    <Entry Grid.Column="1"
                           Placeholder="ポート"
                           Text="{Binding Port}"
                           IsEnabled="{Binding IsConnected, Converter={StaticResource InvertedBoolConverter}}"
                           Keyboard="Numeric" />
                </Grid>

                <Grid ColumnDefinitions="*,*"
                      ColumnSpacing="12">
                    <Button Grid.Column="0"
                            Text="接続"
                            Command="{Binding ConnectCommand}"
                            BackgroundColor="#2196F3"
                            TextColor="White" />

                    <Button Grid.Column="1"
                            Text="切断"
                            Command="{Binding DisconnectCommand}"
                            BackgroundColor="#F44336"
                            TextColor="White" />
                </Grid>
            </VerticalStackLayout>
        </Border>

        <!-- 映像表示エリア -->
        <Border Grid.Row="1"
                StrokeShape="RoundRectangle 8"
                Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#3E3E3E}"
                BackgroundColor="{AppThemeBinding Light=#000000, Dark=#121212}">
            <skia:SKCanvasView x:Name="CanvasView"
                               PaintSurface="OnCanvasViewPaintSurface" />
        </Border>

        <!-- ステータスバー -->
        <Border Grid.Row="2"
                Padding="12,8"
                Margin="0,16,0,0"
                StrokeShape="RoundRectangle 4"
                Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#3E3E3E}"
                BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}">
            <HorizontalStackLayout Spacing="8">
                <Label Text="ステータス:"
                       VerticalOptions="Center" />
                <Label Text="{Binding StatusMessage}"
                       VerticalOptions="Center"
                       FontAttributes="Bold" />
            </HorizontalStackLayout>
        </Border>
    </Grid>
</ContentPage>
